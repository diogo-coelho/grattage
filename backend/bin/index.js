"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=__importDefault(require("fs")),path_1=__importDefault(require("path")),Server_1=__importDefault(require("./config/Server")),FormattedDate_1=__importDefault(require("./utils/FormattedDate")),httpServer=new Server_1.default;httpServer.server.then(t=>{t.listen(httpServer.port),t.on("error",function(e){if("listen"!==e.syscall)throw e;var t="string"==typeof httpServer.port?"Pipe "+httpServer.port:"Porta "+httpServer.port;switch(e.code){case"EACCES":httpServer.closeDatabase(),console.error(`[ ${FormattedDate_1.default.formattedDate} ] : ${t} requer privilégios elevados de acesso`),fs_1.default.appendFileSync(path_1.default.join(__dirname,"../logs/server.log"),`[ ${FormattedDate_1.default.formattedDate} ] : ${t} requer privilégios elevados de acesso \r
`),process.exit(1);break;case"EADDRINUSE":httpServer.closeDatabase(),console.log(`[ ${FormattedDate_1.default.formattedDate} ] : ${t} já está em uso`),fs_1.default.appendFileSync(path_1.default.join(__dirname,"../logs/server.log"),`[ ${FormattedDate_1.default.formattedDate} ] : ${t} já está em uso \r
`),process.exit(1);break;default:throw httpServer.closeDatabase(),e}}),t.on("listening",function(){var e=t.address();e&&(e="string"==typeof e?"pipe "+e:"porta "+e.port,console.log(`[ ${FormattedDate_1.default.formattedDate} ] : Servidor rodando na `+e),fs_1.default.appendFileSync(path_1.default.join(__dirname,"../logs/server.log"),`[ ${FormattedDate_1.default.formattedDate} ] : Servidor rodando na ${e} \r
`))}),t.setTimeout(0)}).catch(e=>{console.log(`[ ${FormattedDate_1.default.formattedDate} ] : Não foi possível inicializar o servidor `+e.stack),fs_1.default.appendFileSync(path_1.default.join(__dirname,"../logs/server.log"),`[ ${FormattedDate_1.default.formattedDate} ] : Não foi possível inicializar o servidor ${e.stack} \r
`)});